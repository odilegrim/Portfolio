---
title: "Portfolio Computational Musicology"
author: "Odile Grim"
date: "March 2021"
output: 
  flexdashboard::flex_dashboard:
    theme: journal
---
```{r}
library(plotly)
library(spotifyr)
library(ggplot2)
library(tidyverse)
library(compmus)
library(gridExtra)
```



**Homework week 9** {.storyboard}
=======================================================

### **Chordograms** for BMTH's singles


```{r, fig.width = 12, fig.height = 10}
  circshift <- function(v, n) {
    if (n == 0) v else c(tail(v, n), head(v, -n))
  }

#      C     C#    D     Eb    E     F     F#    G     Ab    A     Bb    B
major_chord <-
  c(   1,    0,    0,    0,    1,    0,    0,    1,    0,    0,    0,    0)
minor_chord <-
  c(   1,    0,    0,    1,    0,    0,    0,    1,    0,    0,    0,    0)
seventh_chord <-
  c(   1,    0,    0,    0,    1,    0,    0,    1,    0,    0,    1,    0)


chord_templates <-
  tribble(
    ~name, ~template,
    "Gb:7", circshift(seventh_chord, 6),
    "Gb:maj", circshift(major_chord, 6),
    "Bb:min", circshift(minor_chord, 10),
    "Db:maj", circshift(major_chord, 1),
    "F:min", circshift(minor_chord, 5),
    "Ab:7", circshift(seventh_chord, 8),
    "Ab:maj", circshift(major_chord, 8),
    "C:min", circshift(minor_chord, 0),
    "Eb:7", circshift(seventh_chord, 3),
    "Eb:maj", circshift(major_chord, 3),
    "G:min", circshift(minor_chord, 7),
    "Bb:7", circshift(seventh_chord, 10),
    "Bb:maj", circshift(major_chord, 10),
    "D:min", circshift(minor_chord, 2),
    "F:7", circshift(seventh_chord, 5),
    "F:maj", circshift(major_chord, 5),
    "A:min", circshift(minor_chord, 9),
    "C:7", circshift(seventh_chord, 0),
    "C:maj", circshift(major_chord, 0),
    "E:min", circshift(minor_chord, 4),
    "G:7", circshift(seventh_chord, 7),
    "G:maj", circshift(major_chord, 7),
    "B:min", circshift(minor_chord, 11),
    "D:7", circshift(seventh_chord, 2),
    "D:maj", circshift(major_chord, 2),
    "F#:min", circshift(minor_chord, 6),
    "A:7", circshift(seventh_chord, 9),
    "A:maj", circshift(major_chord, 9),
    "C#:min", circshift(minor_chord, 1),
    "E:7", circshift(seventh_chord, 4),
    "E:maj", circshift(major_chord, 4),
    "G#:min", circshift(minor_chord, 8),
    "B:7", circshift(seventh_chord, 11),
    "B:maj", circshift(major_chord, 11),
    "D#:min", circshift(minor_chord, 3)
  )

ludens <-
  get_tidy_audio_analysis("4xWirulal0kGikFE3WSU75") %>%
  compmus_align(sections, segments) %>%
  select(sections) %>%
  unnest(sections) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"
      )
  ) 

ludensplot_chord <- ludens %>% 
  compmus_match_pitch_template(
    chord_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "chebyshev"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "", title = "Ludens") +
  theme(text = element_text(family = "mono")) +
  theme(axis.text.y = element_text(size = 11),
        axis.text.x = element_text(size = 11),
        plot.title = element_text(size = 18))

mantra <-
  get_tidy_audio_analysis("060RNnzoMay3wKJek1faPc") %>%
  compmus_align(sections, segments) %>%
  select(sections) %>%
  unnest(sections) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"
      )
  ) 

mantraplot_chord <- mantra %>% 
  compmus_match_pitch_template(
    chord_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "chebyshev"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "", title = "MANTRA") +
  theme(text = element_text(family = "mono")) +
  theme(axis.text.y = element_text(size = 11),
        axis.text.x = element_text(size = 11),
        plot.title = element_text(size = 18))


drown <-
  get_tidy_audio_analysis("6o39Ln9118FKTMbM4BvcEy") %>%
  compmus_align(sections, segments) %>%
  select(sections) %>%
  unnest(sections) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"
      )
  ) 

drownplot_chord <- drown %>% 
  compmus_match_pitch_template(
    chord_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "chebyshev"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "", title = "Drown") +
  theme(text = element_text(family = "mono")) +
  theme(axis.text.y = element_text(size = 11),
        axis.text.x = element_text(size = 11),
        plot.title = element_text(size = 18))

shadowmoses <-
  get_tidy_audio_analysis("68osIGtVjM7QWVe6pazLHj") %>%
  compmus_align(sections, segments) %>%
  select(sections) %>%
  unnest(sections) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"
      )
  ) 

shadowmosesplot_chord <- shadowmoses %>% 
  compmus_match_pitch_template(
    chord_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "chebyshev"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "", title = "Shadow Moses") +
  theme(text = element_text(family = "mono")) +
  theme(axis.text.y = element_text(size = 11),
        axis.text.x = element_text(size = 11),
        plot.title = element_text(size = 18))

chelseasmile <-
  get_tidy_audio_analysis("2C5jGbR23YLonV7Lton6fV") %>%
  compmus_align(sections, segments) %>%
  select(sections) %>%
  unnest(sections) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"
      )
  ) 

chelseasmileplot_chord <- chelseasmile %>% 
  compmus_match_pitch_template(
    chord_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "chebyshev"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "", title = "Chelsea Smile") +
  theme(text = element_text(family = "mono")) +
  theme(axis.text.y = element_text(size = 11),
        axis.text.x = element_text(size = 11),
        plot.title = element_text(size = 18))

prayforplagues <-
  get_tidy_audio_analysis("0zYxfgyqypkG7rRwFqyisT") %>%
  compmus_align(sections, segments) %>%
  select(sections) %>%
  unnest(sections) %>%
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"
      )
  ) 

prayforplaguesplot_chord <- prayforplagues %>% 
  compmus_match_pitch_template(
    chord_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "chebyshev"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "", title = "Pray For Plagues") +
  theme(text = element_text(family = "mono")) +
  theme(axis.text.y = element_text(size = 11),
        axis.text.x = element_text(size = 11),
        plot.title = element_text(size = 18))


grid.arrange(prayforplaguesplot_chord, chelseasmileplot_chord, 
             shadowmosesplot_chord,
             drownplot_chord, mantraplot_chord, ludensplot_chord, 
             nrow = 2, ncol = 3)





```

***

These are **chordograms** for some of the singles of all of Bring Me The Horizons albums in the old and new music categories (the experimental catagory doesn't have any singles), arranged from oldest to newest (left to right, top to bottom). As you can see, there is a lot going on in all these songs. When listening to the music you can easily follow along in the chordograms. Loud percussion and distorted guitar sounds can make for **bright yellow lines**, like the one around 70 seconds in *Shadow Moses*. Considering this, it is clearly visible that Bring Me The Horizon keep using this a lot in their music over time. It is interesting to see that the screaming in *Pray For Plagues* leads to less intense recognition of chords, but does not necessarily create the bright yellow areas mentioned before. 

When comparing the songs to see what happened to BMTH's music over time, you could say that **their music has become more varied**. The older songs have a simpler pattern than the newer songs, which have a lot of changes in them.



**Introduction**
===============================================================

### **What my analysis is about**
For my corpus I will look at the repertoire of Bring Me The Horizon. Since the release of their first four albums, which can, according to Google, all be classified as "metalcore", their music has progressed more towards alternative-/pop-/electronic-rock and they even released an [EP with experimental and electronic music](https://open.spotify.com/album/6yC6aLzX5knhWpKDidwxft). Having been in their fanbase since around 2013, when *Sempiternal* was released, I myself experienced the changes in their music. Some people argue that only their "old" music is good and their new music is "too soft", leading to them not listening to the band's music anymore. My question is, what exactly has changed about their music, which aspects have remained similar to their early music and which haven't? 

I definitely think that BMTH's music after 2013 has changed significantly compared to their earlier music and it will be most interesting to dive deeper into their work from that time on. As for specific tracks to look at *Pray for Plagues*, *Chelsea Smile* and *Shadow Moses* from their earlier work and *Drown*, *Mantra* and *Ludens* from their more recent work might be representative tracks, as they were all released as singles and thus viewed as important. Some of their more recent albums include different genres within them, so it might also be useful to examine those more closely and determine what and how big those differences are and whether they are significant.

### .........................................................................................................................................................................................................................................................................................................................................
![](https://www.impericon-mag.com/nl/wp-content/uploads/sites/7/2020/10/bringmethehorizon.jpg)

**Analysis** {.storyboard}
=============================================================

### **First things first**: Different music styles over the years compared

```{r, fig.width = 8.4}
library(tidyverse)
library(spotifyr)
library(plotly)

old <- get_playlist_audio_features("", "6oeRMX8XZ8IS7MCDb6Z1BG")
new <- get_playlist_audio_features("", "4k98rVhcCw54dhLaUMiyLK")
experimental <- get_playlist_audio_features("", "1EIpRI9TozVUiehlxAmmHq")

oldvsnew <-
  bind_rows(
    old %>% mutate(category = "Old music"),
    new %>% mutate(category = "New music"),
    experimental %>% mutate(category = "Experimental")
  )

differentstyles <- ggplot(oldvsnew, 
                          aes(x = valence, y = energy, color = speechiness, size = danceability)) +
  geom_jitter(alpha = 0.5) +
  facet_wrap(~category) +
  scale_color_gradient(low = "black", high = "purple")+
  theme_linedraw() +
  labs(title = "Bring Me The Horizon: different music styles") +
  theme(plot.title = element_text( 
    face = "bold", 
    color = "black",
    hjust = 0.5,
    size = 13)) +
  theme(legend.title = element_text(
    color = "black",
    size = 12
  )) +
  theme(axis.title = element_text(
    size = 12)) +
  xlab("Valence") + ylab("Energy") +
  theme(strip.text.x =  element_text(family = "mono")) +
  geom_text(
    aes(x = valence, y = energy, label = label),
    data = tibble(label = c("A Devastating 
    Liberation", 
                            "i apologise if 
    you feel something",
                            "Memorial"), 
                  category = c("Experimental", "New music", "Old music"), 
                  valence = c(0.15, 0.165, 0.12),
                  energy = c(0.17, 0.345, 0.0451)),
    color = "darkred",
    size = 3,
    family = "mono"
  ) +
  geom_text(
    aes(x = valence, y = energy, label = label),
    data = tibble(label = c("Danceable", "Not danceable" ),
                  category = c("New music", "New music"),
                  valence = c(0.375, 0.4),
                  energy = c(0.55, 0.47)),
    color = "grey30",
    size = 2.8,
    family = "mono"
  ) +
  theme(text = element_text(family = "mono"))

ggplotly(differentstyles)
  
```

***

For this plot I have split Bring Me The Horizon's music into three different categories, "Old Music", their first four albums, "New music", their three most recent releases, with exception of their experimental music from *Music to listen to~*, which is the third category. This album isn't exactly representative of either their "new" or "old" music style, so I made it a separate category (hence "Experimental").
  It is easily visible that BMTH's new music is much more varied than their old music. Considering that high energy + low valence = angry music, and high energy + high valence = happy music, we could conclude that their music has overall become happier. The experimental music has very low valence values, like BMTH's old music, and is also more angry and negative. Each category seems to have outliers that fall into the 'sad music' area, they are labeled in the plot.
  
With the highest danceability score being 0.6 out of a possible maximum of 1, most of their music isn't very danceable, but their newer music generally scores higher. The speechiness seems to be higher with higher valence scores, but generally the music doesn't seem very speechy. Looking at all their work together, the music seems very energetic and seems to have progressed from negative and angry towards a more diverse and positive style, with almost a kind of "dip" back towards negativity in their experimental album. 
  
### **Chromagram** for the **saddest** song in Bring Me The Horizon's repertoire

```{r}
library(spotifyr)
library(compmus)
library(tidyverse)

memorial <- get_tidy_audio_analysis("2VseRAuxHRFtlvr5zP1fKE?si=6d86a7afadaa4b93") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

memorial %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() +
  theme(text = element_text(family = "mono")) +
  labs(title = "Memorial")




```


***

This is a chromagram of the song *Memorial*, which is, according to it's measurements of valence and energy, the **saddest** song in Bring Me The Horizon's entire repertoire. As you can see, the song is **quite repetitive** and has a few layers that really stand out. *Memorial* is an entirely instrumental song with a continuous underlying sound and is used in the album as a transition into the next track. There are clearly audible, and in the chromagram visible, **high and loud 'screeching' noises** in the song and a few notes that are softly and repeatedly being played throughout the song. The texture of the song is very simple and also very clearly repesented in this chromagram.

### **Chromagram** for the **happiest** song in Bring Me The Horizon's repertoire

```{r}
library(spotifyr)
library(compmus)
library(tidyverse)

onebyone <- get_tidy_audio_analysis("6sIbv1oWOuma2qV907MUbk") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

onebyone %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() +
  theme(text = element_text(family = "mono")) +
  labs(title = "1x1 (feat. Nova Twins)")

```

***
This is a chromagram of the song *1x1 (feat. Nova Twins)*, which is, according to it's measurements of valence and energy, the **happiest** song in Bring Me The Horizon's entire repertoire. As you can see, this song is **all over the place**. The line of C#/Db stands out a little bit, with a higher magnitude overall. The song consists of heavy drums and guitar combined with electronic music and keyboard sounds, all accompanied by the singing voices of either Bring Me The Horizon's frontman Oliver Sykes or the featuring artist the Nova Twins. The only big visible thing that is happening here is at **around 160 seconds**, where the heavy instruments that support the rest of the song go quiet and we hear only a keyboard and a singing voice.

### **Cepstrograms** for the most "average" songs

```{r}
  library(spotifyr)
library(ggplot2)
library(tidyverse)
library(compmus)
library(plotly)
library(Rmisc)

swoeo <-
  get_tidy_audio_analysis("1JGhCrOUIPdYG2n6K26SXE") %>% # Change URI.
  compmus_align(sections, segments) %>%                     # Change `bars`
  select(sections) %>%                                      #   in all three
  unnest(sections) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

swoeoplot <- swoeo %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() +
  labs(title = "Sleep With One Eye Open") +
  theme(text = element_text(family = "mono"))

ouch <-
  get_tidy_audio_analysis("1PWFyfV7yYhlxHZX2g25wS") %>% # Change URI.
  compmus_align(sections, segments) %>%                     # Change `bars`
  select(sections) %>%                                      #   in all three
  unnest(sections) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

ouchplot <- ouch %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() +
  labs(title = "Ouch") +
  theme(text = element_text(family = "mono"))

library(gridExtra)
grid.arrange(swoeoplot, ouchplot, nrow = 2)

```

***

Cepstrograms for the songs that lay the closes to the average energy, valence and danceability in BMTH's old music (*Sleep With One Eye Open*) and new music (*Ouch*). As you can see the cepstrograms both have more intensity in the bottom, but *Sleep With One Eye Open* is "squished down" even more than *Ouch*. Both songs have a focus on the c02 section and generally go up to c06. Even though both songs do not have a lot of intensity in c07 to 12, *Ouch* does seem to have a bit more intensity there than *Sleep With One Eye Open*. This shows that the timbre features of the songs are quite different from each other.

### **Self similarity matrices** for popular and not so popular songs

```{r}
cyfmh <-
  get_tidy_audio_analysis("0WSa1sucoNRcEeULlZVQXj") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "mean", norm = "manhattan"              # Change summary & norm.
      )
  )
cyfmhplot_selfsim <- cyfmh %>%
  compmus_self_similarity(timbre, "cosine") %>% 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "") +
  labs(title = "Can You Feel My Heart") +
  theme(text = element_text(family = "mono"))

kingslayer <-
  get_tidy_audio_analysis("7CAbF0By0Fpnbiu6Xn5ZF7") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "mean", norm = "manhattan"              # Change summary & norm.
      )
  )
kingslayerplot_selfsim <- kingslayer %>%
  compmus_self_similarity(timbre, "cosine") %>% 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "") +
  labs(title = "Kingslayer") +
  theme(text = element_text(family = "mono"))


liquorandlove <-
  get_tidy_audio_analysis("4djz9dpEMMCYwkADOvrCZL") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "mean", norm = "manhattan"              # Change summary & norm.
      )
  )
liquorandlove_selfsim <- liquorandlove %>%
  compmus_self_similarity(timbre, "cosine") %>% 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "") +
  labs(title = "Liquor & Love Lost") +
  theme(text = element_text(family = "mono"))

alotlikevegas <-
  get_tidy_audio_analysis("6qa1eyvDHXyaiA6a68kKvr") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
          compmus_summarise, pitches,
          method = "mean", norm = "manhattan"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
          compmus_summarise, timbre,
          method = "mean", norm = "manhattan"              # Change summary & norm.
      )
  )
alotlikevegasplot_selfsim <- alotlikevegas %>%
  compmus_self_similarity(timbre, "cosine") %>% 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "") +
  labs(title = "A Lot Like Vegas") +
  theme(text = element_text(family = "mono"))


grid.arrange(cyfmhplot_selfsim, kingslayerplot_selfsim, 
             liquorandlove_selfsim, alotlikevegasplot_selfsim, 
             nrow = 2, ncol = 2)
```

***

These are **self-similarity matrices** for some of Bring Me The Horizons most popular songs (*Can You Feel My Heart* and *Kingslayer (feat. BABYMETAL)*) and some of their least popular songs (*Liquor & Love Lost* and *A Lot Like Vegas*). A quick look at these figures shows you that the popular songs have **more distinct checkerboard patterns** in them, which shows that they are more homogenous. *A Lot Like Vegas* also has a checkerboard pattern in it, but one that is divided into bigger chunks. The popular songs are homogenous, but also **alternate more** between the different sections in the song, which could be a reason they are more popular. The **bright criss-crossing lines** indicate moments in the music that are different from everything else, *Liquor & Love Lost* does not seem to have a lot of those moments, which could be a reason the song is less well-liked. On the other hand, *A Lot Like Vegas* does seem to have quite a bit of those moments, so it is probably a combination with other factors. 


Conclusion
=============================================================================

*Coming soon...*


